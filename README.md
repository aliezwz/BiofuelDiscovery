# BiofuelDiscovery
## 1. Introduction
In BiofuelDiscovery project, we trained three classifier models using Gaussian processes, random forests, and semi-supervised learning algorithms. We then used the SMILES of biofuels classified by these models to train the GAN model. Finally, we added the unique molecules created by the GAN to the total database and repeated the training cycle.
## 2. Tutorial
### 2.1 Prepare the database
To run BiofuelDiscovery project, firstly you need to prepare a dataset containing biofuel molecules and fossil fuel molecules. Here, we call it "training dataset". This dataset should contains columns for "Name", "Smiles" and "Types". The "Name" column contains the name of the molecule. The "Smiles" column contains the **SMILES**(simplified molecular-input line-entry system) of the molecule, **SMILES** is a specification in the form of a line notation for describing the structure of chemical species using short ASCII strings[[1]](https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system), you can search for smiles for each molecule on PubChem or use rdkit to generate smiles.  

In addition to the "training database", you still need to prepare a large database containing many biomass molecules. We call it the "Classification Database".

### 2.2 Installation
The python version we use is 3.8.  
In addition to some commonly used data science libraries, you still need to install some machine learning and chemical information software libraries.   

```
pip install scikit-learn  
pip install torch  
pip install tensorflow  
pip install deepchem  
```  
Additionally, if you want to know all the libraries needed to run Molgan, please check requirements.txt. Also more information you can check the deepchem tutorials.  
[Deepchem tutorials](https://github.com/deepchem/deepchem/blob/master/examples/tutorials/Generating_molecules_with_MolGAN.ipynb)
### 2.3 How to 
In order to run the project, user should follow the following steps:  
1-Select any model in the Classifier fold and train it using trining database. You will get a trianed modle.  
2-Use the trained model to classify your dataset. You will get a database with labels "biofuel" and "non-biofuel".  
3-Save the dataset you used in step 1 and the smiles of the molecules with the label "biofuel" in the newly obtained dataset, and create a new dataset.  
4-Use SMILES dataset to train MolGAN. The MolGAN will generate more unique and vaild smiles.  
5-Merge smiles generated by molgan into "Dataset.csv"  
6-Repeat steps 2-5 and you will get a large number of unique and meaningful biofuel molecules.

# 3.Result
This is your "Classification Dataset"
| Name | Smiles | Types |
|-------------------|------------------|---------------|
| 2-Methylpentane   | CCCC(C)C         |      |
| 3-Methylpentane   | CCC(C)CC         |      |
| 2,3-Dimethylbutane| CC(C)C(C)C       |      |
| 2-Methylhexane    | CCCCC(C)C        |      |
| 3-Methylhexane    | CCCC(C)CC        |      |
| 2,2-Dimethylpentane| CCCC(C)(C)C     |      |
| 3,3-Dimethylpentane| CCC(C)(C)CC     |      |

After step 2, you will get a dataset with label.
| Name | Smiles | Types |
|-------------------|------------------|---------------|
| 2-Methylpentane   | CCCC(C)C         | Biofuel       |
| 3-Methylpentane   | CCC(C)CC         | Not biofuel   |
| 2,3-Dimethylbutane| CC(C)C(C)C       | Not biofuel   |
| 2-Methylhexane    | CCCCC(C)C        | Biofuel       |
| 3-Methylhexane    | CCCC(C)CC        | Not biofuel   |
| 2,2-Dimethylpentane| CCCC(C)(C)C      | Biofuel       |
| 3,3-Dimethylpentane| CCC(C)(C)CC      | Biofuel       |

For Molgan, every time you run it, you will get a series of smiles.
| Generated SMILES                   |
|------------------------------------|
| CCCC                               |
| CCCO                               |
| CC12CC3(C4OC41)C1CC34CC124         |
| CCC                                |
| CCC1C2C3C4C3C4C(C)C12C             |
| OCCO                               |
| CC                                 |
| CCC1(C)CC1                         |
| CCOO                               |
| CC12C3CCC4C15C1C32C415             |
| C=CC                               |
| O=CO                               |
| CCC=CC1CC1                         |
| CCO                                |
| CC1=CC1                            |
| CC(C)(C)C1(C)CC1                   |
| CC=CCCC                            |
| CC(CO)C1(C)C(C)CC12CC2             |
| …………                               |
# Dataset
In Dataset fold, we have four datasets, "Training dataset.csv" is used for three Classifiers, “Smiles list.csv" is used for Molgan to generate SMILES, "SemiSupervised_Dataset.csv" is used for Semi-Supervised Learning model, but it have some problem. In addition, we also have a file called "Rd_SMILES".csv, which is used to expand the database.
# Classifier
In Classifier fold, we have three models, these classifiers are used to distinguish biofuels from fossil fuels in the "Dataset.csv".
# Gan
In Gan fold, we use MolGAN to generated unique vaild molecules.  
The MolGAN network was initially presented by Cao and Kipf in their work "MolGAN: An implicit generative model for small molecular graphs[[2]](https://arxiv.org/abs/1805.11973)  
In MolGAN, we have many parameters, here we will introduce some important parameters in MolGAN. You can change these parameters to explore MolGAN.  
```
num_atoms = 12
```
The **num_atoms** parameter determines the maximum size of molecules to be processed and generated. The size of the num_atoms parameter directly affects the model's efficiency, data processing capabilities, and the diversity and complexity of the generated results.
```
gan.fit_gan(iterbatches(25), generator_steps=0.2, checkpoint_interval=5000)
```
Here, iterbatches is a funcation。 In this function, you need to pass in the value of **epoch**(25). This means the model will be trained for 25 epochs, with each epoch going through the entire dataset.The size of the epochs value directly affects the model training time, performance, convergence, and risk of overfitting.  

The **generator_steps** parameter controls the frequency and number of steps that the generator updates relative to the discriminator. Here, generator_steps is set to 0.2, so the generator will be updated 0.2 times after each discriminator update, that is, the generator will be updated once after every 5 discriminator updates. The size of the generator_steps parameter affects the update frequency and balance of the generator and discriminator during training.  

```
generated_data = gan.predict_gan_generator(10000)
```
Here, we define the number of molecules we want to generate as 10000. A larger number means more molecules will be generated and more time will be required to generate them. But please make sure you have enough molecular samples for GAN to learn.

# RDkit
In this fold, we have two tools, "SMILES TO Random SMILES.py" can convert SMILES to Random SMILES, "Descriptor.py" can calculate all properties of a molecule based on the SMILES.
# PairPlot
We use PairPlot to visualize the relationships between important descriptors for data exploration.

# Reference
[1] [SMILES](https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system)
[2] [Molgan](https://arxiv.org/abs/1805.11973)
